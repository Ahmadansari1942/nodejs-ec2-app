<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link rel="stylesheet" href="/css/style.css">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <div class="nav-brand">
                <a href="/">ğŸ“‹ Task Manager</a>
            </div>
            <div class="nav-menu">
                <a href="/dashboard">Dashboard</a>
                <a href="/tasks">My Tasks</a>
                <a href="/tasks/create" class="btn btn-primary">+ New Task</a>
                <span class="user-info">ğŸ‘¤ <%= user.username %></span>
                <a href="/auth/logout" class="btn btn-secondary">Logout</a>
            </div>
        </div>
    </nav>

    <main class="main-content">
        <div class="container">
            <div class="page-header">
                <h1>My Tasks</h1>
                <a href="/tasks/create" class="btn btn-primary">+ Create New Task</a>
            </div>

            <% if (tasks.length === 0) { %>
                <div class="empty-state">
                    <div class="empty-icon">ğŸ“­</div>
                    <h3>No tasks yet</h3>
                    <p>Get started by creating your first task</p>
                    <a href="/tasks/create" class="btn btn-primary">Create Task</a>
                </div>
            <% } else { %>
                <div class="task-filters">
                    <button class="filter-btn active" data-filter="all">All Tasks</button>
                    <button class="filter-btn" data-filter="pending">Pending</button>
                    <button class="filter-btn" data-filter="in-progress">In Progress</button>
                    <button class="filter-btn" data-filter="completed">Completed</button>
                </div>

                <div class="tasks-grid">
                    <% tasks.forEach(task => { %>
                        <div class="task-card" data-status="<%= task.status %>">
                            <div class="task-header">
                                <h3><%= task.title %></h3>
                                <span class="priority-badge priority-<%= task.priority %>">
                                    <%= task.priority %>
                                </span>
                            </div>
                            <p class="task-description"><%= task.description %></p>
                            
                            <div class="task-meta">
                                <span class="status-badge status-<%= task.status %>">
                                    <%= task.status.replace('-', ' ') %>
                                </span>
                                <span class="task-date">
                                    <%= new Date(task.createdAt).toLocaleDateString() %>
                                </span>
                            </div>

                            <div class="task-actions">
                                <form action="/tasks/update/<%= task.id %>" method="POST" style="display: inline;">
                                    <select name="status" onchange="this.form.submit()" class="status-select">
                                        <option value="pending" <%= task.status === 'pending' ? 'selected' : '' %>>Pending</option>
                                        <option value="in-progress" <%= task.status === 'in-progress' ? 'selected' : '' %>>In Progress</option>
                                        <option value="completed" <%= task.status === 'completed' ? 'selected' : '' %>>Completed</option>
                                    </select>
                                </form>
                                
                                <a href="/tasks/edit/<%= task.id %>" class="btn btn-sm btn-secondary">Edit</a>
                                
                                <form action="/tasks/delete/<%= task.id %>" method="POST" style="display: inline;" 
                                      onsubmit="return confirm('Are you sure you want to delete this task?')">
                                    <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                                </form>
                            </div>
                        </div>
                    <% }) %>
                </div>
            <% } %>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2024 Task Manager App. Made with â¤ï¸ using Node.js</p>
        </div>
    </footer>

    <script src="/js/main.js"></script>
    <script src="/js/tasks.js"></script>
</body>
</html>
